import{g as U,j as o,m as I,I as m,A as u,i as v,N as w,a as M,L as j,c as N,C as L}from"./Navbar-DOKrkXvf.js";import K,{createContext as A,useState as g,useContext as x,useEffect as y,useRef as P}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";var b=(e=>(e.UK="United Kingdom",e.ES="Spain",e.IT="Italy",e.DK="Denmark",e))(b||{});const c=e=>`https://dynamic-media-cdn.tripadvisor.com/media/${e}?w=300&h=300&s=1`,f=e=>`https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-${e}.png`,$={initialZoom:4,initialCenter:[47.145,6.592],layers:[{name:"Map",urlTemplate:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},{name:"Satellite",urlTemplate:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, GIS"}],groups:[{name:"Home",iconUrl:f("red"),points:[{coords:[51.508039,-.128069],name:"London",countryCode:"UK",info:"just as reference point"}]},{name:"3٭",iconUrl:f("violet"),points:[{coords:[41.9933638,2.8076499],name:"El Celler de Can Roca",countryCode:"ES",info:"2012-11-29, 2015-11-28, 2017-02-14, 2022-11-26",photo:c("photo-o/0d/70/ad/a1/mesas-en-el-comedor-con.jpg")},{coords:[44.6448264,10.9215729],name:"Osteria Francescana",countryCode:"IT",info:"2022-02-11",photo:c("photo-o/11/41/5f/db/suckling-pig-tender-and.jpg")},{coords:[55.6828273,12.6104808],name:"Noma",countryCode:"DK",info:"2019-07-26",photo:c("photo-o/06/ac/ec/de/noma.jpg")},{coords:[41.3877627,2.153199],name:"Disfrutar",countryCode:"ES",info:"2022-11-29",photo:c("photo-o/07/09/74/ac/disfrutar.jpg")},{coords:[51.507914,-.701748],name:"The Fat Duck",countryCode:"UK",info:"2017-05-13",photo:c("photo-o/1f/1e/88/81/nitro-poached-aperitif.jpg")}]},{name:"2٭",iconUrl:f("blue"),points:[{coords:[51.5203787,-.1365322],name:"Kitchen table",countryCode:"UK",info:"2017-06-10 + ???",photo:c("photo-o/1b/2b/13/b1/kitchen-table.jpg")},{coords:[51.5112554,-.1551559],name:"Le Gavroche",countryCode:"UK",info:"Tony 2015-06",photo:c("photo-s/01/83/d5/92/le-gavroche.jpg"),isClosed:!0},{coords:[51.502161,-.159964],name:"Dinner by Heston Blumenthal",countryCode:"UK",info:"Seb 2021-10",photo:c("photo-o/06/ef/22/ed/meat-fruit.jpg")},{coords:[55.6722944,12.5889809],name:"Kadeau",countryCode:"DK",info:"2019-07-27",photo:c("photo-o/13/32/70/a5/photo2jpg.jpg")},{coords:[36.926756,14.741571],name:"Duomo",countryCode:"IT",info:"Seb 2016-10",photo:c("photo-o/29/66/76/e0/duomo-interior.jpg")},{coords:[51.5270972,-.0793385],name:"The Clove Club",countryCode:"UK",info:"2022-05-14",photo:c("photo-o/13/a3/da/2c/raw-orkney-scallop-truffle.jpg")}]},{name:"1٭",iconUrl:f("gold"),points:[{coords:[51.5147644,-.1575224],name:"KOL",countryCode:"UK",info:"2022-10-07",photo:c("photo-o/1c/63/1b/26/kol-restaurant.jpg")},{coords:[41.3767234,2.1540984],name:"Enigma",countryCode:"ES",info:"2022-11-28",photo:c("photo-o/12/15/2b/e2/august-2016.jpg")},{coords:[41.3752608,2.1568707],name:"Tickets",countryCode:"ES",info:"2015-11?? + 2017-02-11",photo:"https://albertadria.com/wp-content/uploads/2023/01/Tickets-%C2%AEPepoSeguraYU5L7900-1024x859.jpg",isClosed:!0},{coords:[51.4926222,-.2676784],name:"Hedone",countryCode:"UK",info:"Tony 2018-06",photo:"https://lh3.googleusercontent.com/p/AF1QipOObLj95F5VElYedHy691CjsvaQXW13jPhM5Aj7=s680-w680-h510",isClosed:!0},{coords:[51.5237542,-.0764767],name:"Lyle's",countryCode:"UK",info:"2022-06-18",photo:c("photo-o/1b/2b/0e/75/lyle-s.jpg")},{coords:[51.5197892,-.1427257],name:"Portland",countryCode:"UK",info:"Maja 2023-02",photo:c("photo-o/07/5a/a5/d3/portland.jpg")}]},{name:"0٭",iconUrl:f("grey"),points:[{coords:[51.5064253,-.1261457],name:"Ekstedt at The Yard",countryCode:"UK",info:"2024-09-28",photo:c("photo-o/2d/9e/16/97/sunday-roast-wood-oven.jpg")},{coords:[51.5189387,-.1355877],name:"ROKA Charlotte Street",countryCode:"UK",info:"2024-10-04 with Tony",photo:c("photo-o/09/5e/21/19/roka-charlotte-street.jpg")},{coords:[41.984698,2.825606],name:"Restaurant Normal",countryCode:"ES",info:"2022-11-25",photo:c("photo-o/2a/69/f9/0f/caption.jpg")},{coords:[41.3845391,2.181679],name:"El Xampanyet",countryCode:"ES",info:"2022-11",photo:c("photo-o/01/cd/bb/31/el-xampanyet.jpg")},{coords:[44.6384889,10.931725],name:"Franceschetta 58",countryCode:"IT",info:"2022-02",photo:c("photo-o/12/f7/f3/9c/photo4jpg.jpg")}]}]},h=A(null),G=({children:e})=>{const s=U(),[t,n]=g(null),[a,i]=g(s.get("page")==="map"),[r,l]=g(null),[d,E]=g(0),T={data:t,setData:n,isMapEnabled:a,setIsMapEnabledWithURL:C=>{i(C),I({page:[C?"map":"list","list"]})},centreZoom:r,setCentreZoom:l,scrollTop:d,setScrollTop:E};return o.jsx(h.Provider,{value:T,children:e})},D=({origin:e,destination:s,centreZoom:t,isSatellite:n,hasTraffic:a,isByFoot:i})=>{if(s&&!e)throw new Error("Cannot have destination without origin");const r=s?"dir":"place";let l=`https://www.google.com/maps/${r}`;e&&(l+=`/${e}`),s&&(l+=`/${s}`),t&&(l+=`/@${t}`);let d=n?"!3m2!1e3!4b1":"!3m1!4b1";return r==="dir"&&(d+=i?"!4m2!4m1!3e2":"!4m2!4m1!3e0"),a&&(d+="!5m1!1e1"),l+(d.length>0?`/data=${d}`:"")},R=e=>encodeURIComponent(e).replaceAll("%20","+"),S=e=>{const s=/^\d+/.exec(e);return s?parseInt(s[0]):0},k=e=>{const s=b[e.countryCode],t=R(`${e.name}, ${s}`);return{michelin:"https://guide.michelin.com/en/restaurants?q="+t,tripAdv:"https://www.tripadvisor.co.uk/Search?ssrc=e&q="+t,yelp:`https://www.yelp.co.uk/search?find_desc=${e.name}&find_loc=${s}`,gmap:D({origin:e.coords.join(","),centreZoom:e.coords.join(",")+",12z"}),weather:"https://www.wunderground.com/calendar/"+e.coords.join(",")}},Z=({groups:e})=>{const s=x(h);return y(()=>{document.documentElement.scrollTop=document.body.scrollTop=s.scrollTop},[]),o.jsx("div",{children:e.filter(t=>t.name!=="Home").map((t,n)=>o.jsx(F,{group:t},n))})},F=({group:e})=>{const s=S(e.name);return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"x-list-delimiter",children:e.name}),o.jsx("div",{id:"x-list-container",children:e.points.map((t,n)=>o.jsx(O,{point:t,numStars:s},n))})]})},O=({point:e,numStars:s})=>{const t=x(h),n=r=>{r.preventDefault(),t.setScrollTop(document.documentElement.scrollTop||document.body.scrollTop),t.setCentreZoom([e.coords[0],e.coords[1],15]),t.setIsMapEnabledWithURL(!t.isMapEnabled)},a=k(e),i=[...Array(s).keys()].map(r=>o.jsx("i",{className:"fa-solid fa-star-of-life x-star"},r));return o.jsxs("div",{className:"x-list-item",children:[e.photo&&o.jsx("div",{className:"x-list-photo",children:o.jsx(m,{src:e.photo})}),o.jsxs("div",{className:"x-list-item-bottom"+(e.isClosed?" x-list-item-closed":""),children:[e.isClosed&&o.jsx("div",{className:"x-list-item-info-closed",children:"Permanently closed"}),o.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:o.jsxs("div",{className:"x-list-item-title",children:[e.name,o.jsx("span",{style:{whiteSpace:"nowrap"},children:i})]})}),o.jsx("div",{className:"x-list-item-country",children:b[e.countryCode]}),e.info&&o.jsx("div",{className:"x-list-item-info",children:e.info}),o.jsxs("div",{children:[o.jsx(u,{href:a.michelin,children:o.jsx(m,{title:"Guide Michelin",src:"https://designsystem.michelin.com/favicon.ico",className:"x-list-item-link"})}),o.jsx(u,{href:a.tripAdv,children:o.jsx(m,{title:"Trip Advisor",src:"https://static.tacdn.com/favicon.ico",className:"x-list-item-link"})}),o.jsx(u,{href:a.yelp,children:o.jsx(m,{title:"Yelp",src:"https://s3-media0.fl.yelpcdn.com/assets/srv0/yelp_large_assets/dcfe403147fc/assets/img/logos/favicon.ico",className:"x-list-item-link"})}),o.jsx(u,{href:a.gmap,children:o.jsx(m,{title:"Google Maps",src:"https://mapsplatform.google.com/static/images/favicon.ico",className:"x-list-item-link"})}),o.jsx("i",{className:"fa-solid fa-map x-list-item-link",onClick:n,style:{color:"#005bc5"},title:"Go to Map"}),o.jsx(u,{href:a.weather,children:o.jsx("i",{className:"fa-solid fa-cloud-sun-rain x-list-item-link",style:{color:"#d5c645"},title:"Weather Forecast"})})]})]})]})},p=window.L,_=()=>{const e=x(h),s=P(null),[t,n]=g(null);return y(()=>{if(s.current===null)console.log("SKIP: Map div is not yet created (cannot create map yet)");else if(t!==null)console.log("SKIP: Map is already created (nothing to do)");else if("_leaflet_id"in s.current)console.log("SKIP: Map is already in the process of being created");else if(!e.data)console.error("Data not loaded yet...");else{console.log("Create a new Map");const a=W(s.current,e,e.data);n(a)}return()=>{t===null?console.log("SKIP: Map was already removed"):(console.log("Cleanup map"),t.remove())}},[t]),o.jsx("div",{id:"x-map",ref:s})},W=(e,s,t)=>{const n=Object.fromEntries(t.layers.map(r=>[r.name,p.tileLayer(r.urlTemplate,{attribution:r.attribution})])),a=H(t.groups),i=new p.Map(e,{center:s.centreZoom?s.centreZoom.slice(0,2):t.initialCenter,zoom:s.centreZoom?s.centreZoom[2]:t.initialZoom+(v?1:0),zoomControl:v,layers:[n.Map,...Object.values(a)]});return i.attributionControl.setPrefix(!1),p.control.scale({position:"bottomleft"}).addTo(i),p.control.layers(n,a).addTo(i),i.on("moveend",function(){const r=i.getCenter(),l=i.getZoom();s.setCentreZoom([r.lat,r.lng,l])}),i},H=e=>{const s={};let t=0;return e.forEach(n=>{const a={icon:new p.Icon({iconUrl:n.iconUrl,iconAnchor:[Math.round(12.5),41],shadowUrl:"https://cdn.jsdelivr.net/npm/leaflet/dist/images/marker-shadow.png"})},i=n.points.map(r=>{const l=`${n.name}: ${r.name}`;return p.marker(r.coords,a).bindTooltip(l,{permanent:!0,direction:"bottom",className:"x-tooltip"}).bindPopup(z(r,n.name),{className:"x-popup"}).setZIndexOffset(t--)});s[n.name]=p.layerGroup(i)}),s},z=(e,s)=>{const t=(l,d)=>`<a href="${l}" target="_blank" rel="noreferrer">${d}</a>`,n=k(e),a=[t(n.gmap,"Google Maps"),t(n.weather,"Weather Forecast")];s!=="Home"&&(a.push("Search on "+t(n.michelin,"Michelin guide")),a.push("Search on "+t(n.tripAdv,"Trip Advisor"))),e.info&&a.push("info: "+e.info);const i=S(s),r='<i class="fa-solid fa-star-of-life x-star"></i>'.repeat(i);return[`<strong>${e.name}</strong>${r}`,"<ul>",...a.map(l=>`<li>${l}</li>`),"</ul>"].join(`
`)},B=()=>{const e=x(h),s=()=>{const a=!e.isMapEnabled;e.setIsMapEnabledWithURL(a),a&&(e.setScrollTop(0),e.setCentreZoom(null))},t=e.isMapEnabled?"fa-rectangle-list":"fa-map",n=e.isMapEnabled?e.scrollTop?"Back to List":"List":"Map";return o.jsxs(w,{id:"x-navbar",variant:"dark",children:[o.jsx(w.Brand,{children:o.jsx(m,{src:"img/map_restaurants/favicon.png",height:"32"})}),o.jsx(M,{className:"ms-auto me-auto",children:o.jsx(M.Link,{onClick:s,children:o.jsxs("div",{className:"x-toggle-button",children:[o.jsx("i",{className:"fa-solid "+t})," ",n]})})})]})};function Y(){const e=x(h);return y(()=>{e.data===null&&(console.log("Fetch initial data"),e.setData($))},[e.data]),e.data===null?o.jsx("p",{children:"loading..."}):o.jsxs(o.Fragment,{children:[o.jsx(B,{}),o.jsx("main",{children:e.isMapEnabled?o.jsx(_,{}):o.jsxs(o.Fragment,{children:[o.jsx(Z,{groups:e.data.groups}),o.jsx(q,{})]})})]})}const q=()=>o.jsxs("div",{className:"x-shadow",style:{marginTop:"2rem"},children:["Extra links:",o.jsxs("ul",{children:[o.jsx(j,{href:"https://www.theworlds50best.com/Best-of-the-best",children:"World's 50 Best Restaurants"}),o.jsx(j,{href:"https://guide.michelin.com/gb/en",children:"Michelin"}),o.jsx(j,{href:"https://www.laliste.com/en/laliste/world",children:"La Liste"})]})]});N.createRoot(document.getElementById("root")).render(o.jsx(K.StrictMode,{children:o.jsx(L,{children:o.jsx(G,{children:o.jsx(Y,{})})})}));
