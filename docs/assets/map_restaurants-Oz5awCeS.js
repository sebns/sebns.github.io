import{g as T,j as e,m as U,I as h,A as g,i as x,N as v,a as w,L as b,c as I,C}from"./Navbar-DOKrkXvf.js";import N,{createContext as L,useState as u,useContext as f,useEffect as j,useRef as K}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";var r=(o=>(o.UK="United Kingdom",o.ES="Spain",o.IT="Italy",o.DK="Denmark",o))(r||{});const A={initialZoom:4,initialCenter:[47.145,6.592],layers:[{name:"Map",urlTemplate:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},{name:"Satellite",urlTemplate:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, GIS"}],groups:[{name:"Home",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",points:[{coords:[51.508039,-.128069],name:"London",country:r.UK,info:"just as reference point"}]},{name:"3٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-violet.png",points:[{coords:[41.9933638,2.8076499],name:"El Celler de Can Roca",country:r.ES,info:"2012-11-29, 2015-11-28, 2017-02-14, 2022-11-26",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/0d/70/ad/a1/mesas-en-el-comedor-con.jpg?w=300&h=300&s=1"},{coords:[44.6448264,10.9215729],name:"Osteria Francescana",country:r.IT,info:"2022-02-11",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/11/41/5f/db/suckling-pig-tender-and.jpg?w=300&h=300&s=1"},{coords:[55.6828273,12.6104808],name:"Noma",country:r.DK,info:"2019-07-26",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/06/ac/ec/de/noma.jpg?w=300&h=300&s=1"},{coords:[41.3877627,2.153199],name:"Disfrutar",country:r.ES,info:"2022-11-29",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/07/09/74/ac/disfrutar.jpg?w=300&h=300&s=1"},{coords:[51.507914,-.701748],name:"The Fat Duck",country:r.UK,info:"2017-05-13",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1f/1e/88/81/nitro-poached-aperitif.jpg?w=300&h=300&s=1"}]},{name:"2٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png",points:[{coords:[51.5203787,-.1365322],name:"Kitchen table",country:r.UK,info:"2017-06-10 + ???",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1b/2b/13/b1/kitchen-table.jpg?w=300&h=300&s=1"},{coords:[51.5112554,-.1551559],name:"Le Gavroche",country:r.UK,info:"Tony 2015-06. Now closed",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-s/01/83/d5/92/le-gavroche.jpg?w=300&h=300&s=1"},{coords:[51.502161,-.159964],name:"Dinner by Heston Blumenthal",country:r.UK,info:"Seb 2021-10",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/06/ef/22/ed/meat-fruit.jpg?w=300&h=300&s=1"},{coords:[55.6722944,12.5889809],name:"Kadeau",country:r.DK,info:"2019-07-27",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/13/32/70/a5/photo2jpg.jpg?w=300&h=300&s=1"},{coords:[36.926756,14.741571],name:"Duomo",country:r.IT,info:"Seb 2016-10",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/29/66/76/e0/duomo-interior.jpg?w=300&h=300&s=1"},{coords:[51.5270972,-.0793385],name:"The Clove Club",country:r.UK,info:"2022-05-14",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/13/a3/da/2c/raw-orkney-scallop-truffle.jpg?w=300&h=300&s=1"}]},{name:"1٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-gold.png",points:[{coords:[51.5147644,-.1575224],name:"KOL",country:r.UK,info:"2022-10-07",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1c/63/1b/26/kol-restaurant.jpg?w=300&h=300&s=1"},{coords:[41.3767234,2.1540984],name:"Enigma",country:r.ES,info:"2022-11-28",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/12/15/2b/e2/august-2016.jpg?w=300&h=300&s=1"},{coords:[41.3752608,2.1568707],name:"Tickets",country:r.ES,info:"2015-11?? + 2017-02-11. Now closed",photo:"https://albertadria.com/wp-content/uploads/2023/01/Tickets-%C2%AEPepoSeguraYU5L7900-1024x859.jpg"},{coords:[51.4926222,-.2676784],name:"Hedone",country:r.UK,info:"Tony 2018-06. Now closed",photo:"https://lh3.googleusercontent.com/p/AF1QipOObLj95F5VElYedHy691CjsvaQXW13jPhM5Aj7=s680-w680-h510"},{coords:[51.5237542,-.0764767],name:"Lyle's",country:r.UK,info:"2022-06-18",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1b/2b/0e/75/lyle-s.jpg?w=300&h=300&s=1"},{coords:[51.5197892,-.1427257],name:"Portland",country:r.UK,info:"Maja 2023-02",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/07/5a/a5/d3/portland.jpg?w=300&h=300&s=1"}]},{name:"0٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",points:[{coords:[51.5064253,-.1261457],name:"Ekstedt at The Yard",country:r.UK,info:"2024-09-28",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/2d/9e/16/97/sunday-roast-wood-oven.jpg?w=300&h=300&s=1"},{coords:[41.984698,2.825606],name:"Restaurant Normal",country:r.ES,info:"2022-11-25",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/2a/69/f9/0f/caption.jpg?w=300&h=300&s=1"},{coords:[41.3845391,2.181679],name:"El Xampanyet",country:r.ES,info:"2022-11",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/01/cd/bb/31/el-xampanyet.jpg?w=300&h=300&s=1"},{coords:[44.6384889,10.931725],name:"Franceschetta 58",country:r.IT,info:"2022-02",photo:"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/12/f7/f3/9c/photo4jpg.jpg?w=300&h=300&s=1"}]}]},p=L(null),P=({children:o})=>{const t=T(),[a,n]=u(null),[s,c]=u((t.get("page")??"map")==="map"),[i,l]=u(null),[m,S]=u(0),E={data:a,setData:n,isMapEnabled:s,setIsMapEnabledWithURL:y=>{c(y),U({page:[y?"map":"list","map"]})},centreZoom:i,setCentreZoom:l,scrollTop:m,setScrollTop:S};return e.jsx(p.Provider,{value:E,children:o})},G=({origin:o,destination:t,centreZoom:a,isSatellite:n,hasTraffic:s,isByFoot:c})=>{if(t&&!o)throw new Error("Cannot have destination without origin");const i=t?"dir":"place";let l=`https://www.google.com/maps/${i}`;o&&(l+=`/${o}`),t&&(l+=`/${t}`),a&&(l+=`/@${a}`);let m=n?"!3m2!1e3!4b1":"!3m1!4b1";return i==="dir"&&(m+=c?"!4m2!4m1!3e2":"!4m2!4m1!3e0"),s&&(m+="!5m1!1e1"),l+(m.length>0?`/data=${m}`:"")},D=o=>encodeURIComponent(o).replaceAll("%20","+"),M=o=>{const t=/^\d+/.exec(o);return t?parseInt(t[0]):0},k=o=>{const t=D(`${o.name}, ${o.country}`);return{michelin:"https://guide.michelin.com/en/restaurants?q="+t,tripAdv:"https://www.tripadvisor.co.uk/Search?q="+t,gmap:G({origin:o.coords.join(","),centreZoom:o.coords.join(",")+",12z"}),weather:"https://www.wunderground.com/calendar/"+o.coords.join(",")}},R=({groups:o})=>{const t=f(p);return j(()=>{document.documentElement.scrollTop=document.body.scrollTop=t.scrollTop},[]),e.jsx("div",{children:o.filter(a=>a.name!=="Home").map((a,n)=>e.jsx($,{group:a},n))})},$=({group:o})=>{const t=M(o.name);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"x-list-delimiter",children:o.name}),e.jsx("div",{id:"x-list-container",children:o.points.map((a,n)=>e.jsx(Z,{point:a,numStars:t},n))})]})},Z=({point:o,numStars:t})=>{const a=f(p),n=i=>{i.preventDefault(),a.setScrollTop(document.documentElement.scrollTop||document.body.scrollTop),a.setCentreZoom([o.coords[0],o.coords[1],15]),a.setIsMapEnabledWithURL(!a.isMapEnabled)},s=k(o),c=[...Array(t).keys()].map(i=>e.jsx("i",{className:"fa-solid fa-star-of-life x-star"},i));return e.jsxs("div",{className:"x-list-item",children:[o.photo&&e.jsx("div",{className:"x-list-photo",children:e.jsx(h,{src:o.photo})}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:e.jsxs("div",{className:"x-list-item-title",children:[o.name,e.jsx("span",{children:c})]})}),e.jsx("div",{className:"x-list-item-info",children:o.country}),o.info&&e.jsxs("div",{className:"x-list-item-info",children:["info: ",o.info]}),e.jsxs("div",{children:[e.jsx(g,{href:s.michelin,children:e.jsx(h,{title:"Guide Michelin",src:"https://designsystem.michelin.com/favicon.ico",className:"x-list-item-link"})}),e.jsx(g,{href:s.tripAdv,children:e.jsx(h,{title:"Trip Advisor",src:"https://static.tacdn.com/favicon.ico",className:"x-list-item-link"})}),e.jsx(g,{href:s.gmap,children:e.jsx(h,{title:"Google Maps",src:"https://mapsplatform.google.com/static/images/favicon.ico",className:"x-list-item-link"})}),e.jsx("i",{className:"fa-solid fa-map x-list-item-link",onClick:n,title:"Go to Map"}),e.jsx(g,{href:s.weather,children:e.jsx("i",{className:"fa-solid fa-cloud-sun-rain x-list-item-link",style:{color:"#d5c645"},title:"Weather Forecast"})})]})]})},d=window.L,F=()=>{const o=f(p),t=K(null),[a,n]=u(null);return j(()=>{if(t.current===null)console.log("SKIP: Map div is not yet created (cannot create map yet)");else if(a!==null)console.log("SKIP: Map is already created (nothing to do)");else if("_leaflet_id"in t.current)console.log("SKIP: Map is already in the process of being created");else if(!o.data)console.error("Data not loaded yet...");else{console.log("Create a new Map");const s=O(t.current,o,o.data);n(s)}return()=>{a===null?console.log("SKIP: Map was already removed"):(console.log("Cleanup map"),a.remove())}},[a]),e.jsx("div",{id:"x-map",ref:t})},O=(o,t,a)=>{const n=Object.fromEntries(a.layers.map(i=>[i.name,d.tileLayer(i.urlTemplate,{attribution:i.attribution})])),s=W(a.groups),c=new d.Map(o,{center:t.centreZoom?t.centreZoom.slice(0,2):a.initialCenter,zoom:t.centreZoom?t.centreZoom[2]:a.initialZoom+(x?1:0),zoomControl:x,layers:[n.Map,...Object.values(s)]});return c.attributionControl.setPrefix(!1),d.control.scale({position:"bottomleft"}).addTo(c),d.control.layers(n,s).addTo(c),c.on("moveend",function(){const i=c.getCenter(),l=c.getZoom();t.setCentreZoom([i.lat,i.lng,l])}),c},W=o=>{const t={};let a=0;return o.forEach(n=>{const s={icon:new d.Icon({iconUrl:n.iconUrl,iconAnchor:[Math.round(12.5),41],shadowUrl:"https://cdn.jsdelivr.net/npm/leaflet/dist/images/marker-shadow.png"})},c=n.points.map(i=>{const l=`${n.name}: ${i.name}`;return d.marker(i.coords,s).bindTooltip(l,{permanent:!0,direction:"bottom",className:"x-tooltip"}).bindPopup(H(i,n.name),{className:"x-popup"}).setZIndexOffset(a--)});t[n.name]=d.layerGroup(c)}),t},H=(o,t)=>{const a=(l,m)=>`<a href="${l}" target="_blank" rel="noreferrer">${m}</a>`,n=k(o),s=[a(n.gmap,"Google Maps"),a(n.weather,"Weather Forecast")];t!=="Home"&&(s.push("Search on "+a(n.michelin,"Michelin guide")),s.push("Search on "+a(n.tripAdv,"Trip Advisor"))),o.info&&s.push("info: "+o.info);const c=M(t),i='<i class="fa-solid fa-star-of-life x-star"></i>'.repeat(c);return[`<strong>${o.name}</strong>${i}`,"<ul>",...s.map(l=>`<li>${l}</li>`),"</ul>"].join(`
`)},z=()=>{const o=f(p),t=()=>{const s=!o.isMapEnabled;o.setIsMapEnabledWithURL(s),s&&(o.setScrollTop(0),o.setCentreZoom(null))},a=o.isMapEnabled?"fa-rectangle-list":"fa-map",n=o.isMapEnabled?"List":"Map";return e.jsxs(v,{id:"x-navbar",variant:"dark",children:[e.jsx(v.Brand,{children:e.jsx(h,{src:"img/map_restaurants/favicon.png",height:"32"})}),e.jsx(w,{className:"ms-auto me-auto",children:e.jsx(w.Link,{onClick:t,children:e.jsxs("div",{className:"x-toggle-button",children:[e.jsx("i",{className:"fa-solid "+a})," ",n]})})})]})};function _(){const o=f(p);return j(()=>{o.data===null&&(console.log("Fetch initial data"),o.setData(A))},[o.data]),o.data===null?e.jsx("p",{children:"loading..."}):e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx("main",{children:o.isMapEnabled?e.jsx(F,{}):e.jsxs(e.Fragment,{children:[e.jsx(R,{groups:o.data.groups}),e.jsx(B,{})]})})]})}const B=()=>e.jsxs("div",{className:"x-shadow",style:{marginTop:"2rem"},children:["Extra links:",e.jsxs("ul",{children:[e.jsx(b,{href:"https://www.theworlds50best.com/Best-of-the-best",children:"World's 50 Best Restaurants"}),e.jsx(b,{href:"https://guide.michelin.com/gb/en",children:"Michelin"})]})]});I.createRoot(document.getElementById("root")).render(e.jsx(N.StrictMode,{children:e.jsx(C,{children:e.jsx(P,{children:e.jsx(_,{})})})}));
