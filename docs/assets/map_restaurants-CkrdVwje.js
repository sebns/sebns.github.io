import{g as j,j as o,i as h,N as f,a as g,m as b,L as y,c as v,C as w}from"./Navbar-CXp4MzOV.js";import M,{createContext as k,useState as d,useContext as p,useRef as E,useEffect as x}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";const S={initialZoom:4,initialCenter:[47.145,6.592],layers:[{name:"Map",urlTemplate:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},{name:"Satellite",urlTemplate:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, GIS"}],groups:[{name:"Home",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",points:[{coords:[51.508039,-.128069],name:"London",country:"UK",info:"just as reference point"}]},{name:"3٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-violet.png",points:[{coords:[41.9933638,2.8076499],name:"El Celler de Can Roca",country:"ES",info:"2012-11-29, 2015-11-28, 2017-02-14, 2022-11-26"},{coords:[44.6448264,10.9215729],name:"Osteria Francescana",country:"IT",info:"2022-02-11"},{coords:[55.6828273,12.6104808],name:"Noma",country:"DK",info:"2019-07-26"},{coords:[41.3877627,2.153199],name:"Disfrutar",country:"ES",info:"2022-11-29"},{coords:[51.507914,-.701748],name:"The Fat Duck",country:"UK",info:"2017-05-13"}]},{name:"2٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png",points:[{coords:[51.5203787,-.1365322],name:"Kitchen table",country:"UK",info:"2017-06-10 + ???"},{coords:[51.5112554,-.1551559],name:"Le Gavroche",country:"UK",info:"Tony 2015-06"},{coords:[51.502161,-.159964],name:"Dinner by Heston Blumenthal",country:"UK",info:"Seb 2021-10"},{coords:[55.6722944,12.5889809],name:"Kadeau",country:"DK",info:"2019-07-27"},{coords:[36.926756,14.741571],name:"Duomo",country:"IT",info:"Seb 2016-10"},{coords:[51.5270972,-.0793385],name:"The Clove Club",country:"UK",info:"2022-05-14"}]},{name:"1٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-gold.png",points:[{coords:[51.5147644,-.1575224],name:"KOL",country:"UK",info:"2022-10-07"},{coords:[41.3767234,2.1540984],name:"Enigma",country:"ES",info:"2022-11-28"},{coords:[41.3752608,2.1568707],name:"Tickets",country:"ES",info:"2015-11?? + 2017-02-11"},{coords:[51.4926222,-.2676784],name:"Hedone",country:"UK",info:"Tony 2018-06"},{coords:[51.5237542,-.0764767],name:"Lyle's",country:"UK",info:"2022-06-18"},{coords:[51.5197892,-.1427257],name:"Portland",country:"UK",info:"Maja 2023-02"}]},{name:"0٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",points:[{coords:[51.5064253,-.1261457],name:"Ekstedt at The Yard",country:"UK",info:"2024-09-28"},{coords:[41.984698,2.825606],name:"Restaurant Normal",country:"ES",info:"2022-11-25"},{coords:[41.3845391,2.181679],name:"El Xampanyet",country:"ES",info:"2022-11"},{coords:[44.6384889,10.931725],name:"Franceschetta 58",country:"IT",info:"2022-02"}]}]},u=k(null),C=({children:e})=>{const t=j(),[n,r]=d(null),[a,s]=d((t.get("page")??"map")==="map"),[i,c]=d(null),m={data:n,setData:r,isMapEnabled:a,setIsMapEnabled:s,centreZoom:i,setCentreZoom:c};return o.jsx(u.Provider,{value:m,children:e})},U=({groups:e})=>{const t=[];return e.forEach((n,r)=>{n.name!=="Home"&&(t.push(o.jsx("div",{className:"x-delimiter",children:n.name},`${r}`)),n.points.forEach((a,s)=>{t.push(o.jsxs("div",{className:"x-point",children:[o.jsx("div",{className:"x-point-item",style:{textAlign:"left",width:"3rem",maxWidth:"3rem"},children:a.country}),o.jsx("div",{className:"x-point-item",style:{textAlign:"left"},children:a.name}),o.jsx("div",{className:"x-point-item",style:{textAlign:"right",marginLeft:"auto"},children:a.info})]},`${r}-${s}`))}))}),o.jsx("div",{children:o.jsx("div",{id:"x-list-container",children:t})})},I=({origin:e,destination:t,centreZoom:n,isSatellite:r,hasTraffic:a,isByFoot:s})=>{if(t&&!e)throw new Error("Cannot have destination without origin");const i=t?"dir":"place";let c=`https://www.google.com/maps/${i}`;e&&(c+=`/${e}`),t&&(c+=`/${t}`),n&&(c+=`/@${n}`);let m=r?"!3m2!1e3!4b1":"!3m1!4b1";return i==="dir"&&(m+=s?"!4m2!4m1!3e2":"!4m2!4m1!3e0"),a&&(m+="!5m1!1e1"),c+(m.length>0?`/data=${m}`:"")},l=window.L,K=()=>{const e=p(u),t=E(null),[n,r]=d(null);return x(()=>{if(t.current===null)console.log("SKIP: Map div is not yet created (cannot create map yet)");else if(n!==null)console.log("SKIP: Map is already created (nothing to do)");else if("_leaflet_id"in t.current)console.log("SKIP: Map is already in the process of being created");else if(!e.data)console.error("Data not loaded yet...");else{console.log("Create a new Map");const a=T(t.current,e,e.data);r(a)}return()=>{n===null?console.log("SKIP: Map was already removed"):(console.log("Cleanup map"),n.remove())}},[n]),o.jsx("div",{id:"x-map",ref:t})},T=(e,t,n)=>{const r=Object.fromEntries(n.layers.map(i=>[i.name,l.tileLayer(i.urlTemplate,{attribution:i.attribution})])),a=L(n.groups),s=new l.Map(e,{center:t.centreZoom?t.centreZoom.slice(0,2):n.initialCenter,zoom:t.centreZoom?t.centreZoom[2]:n.initialZoom+(h?1:0),zoomControl:h,layers:[r.Map,...Object.values(a)]});return s.attributionControl.setPrefix(!1),l.control.scale({position:"bottomleft"}).addTo(s),l.control.layers(r,a).addTo(s),s.on("moveend",function(){const i=s.getCenter(),c=s.getZoom();t.setCentreZoom([i.lat,i.lng,c])}),s},L=e=>{const t={};let n=0;return e.forEach(r=>{const a={icon:new l.Icon({iconUrl:r.iconUrl,iconAnchor:[Math.round(12.5),41],shadowUrl:"https://cdn.jsdelivr.net/npm/leaflet/dist/images/marker-shadow.png"})},s=r.points.map(i=>{const c=`${r.name}: ${i.name}`;return l.marker(i.coords,a).bindTooltip(c,{permanent:!0,direction:"bottom",className:"x-tooltip"}).bindPopup(N(i,r.name),{className:"x-popup"}).setZIndexOffset(n--)});t[r.name]=l.layerGroup(s)}),t},N=(e,t)=>{const n=(a,s)=>`<a href="${a}" target="_blank" rel="noreferrer">${s}</a>`,r=[n(I({origin:e.coords.join(","),centreZoom:e.coords.join(",")+",12z"}),"Google Map")];return t!=="Home"&&(r.push("Search on "+n("https://guide.michelin.com/en/restaurants?q="+encodeURIComponent(e.name),"Michelin guide")),r.push("Search on "+n("https://www.tripadvisor.co.uk/Search?q="+encodeURIComponent(e.name),"Trip Advisor"))),e.info&&r.push("info: "+e.info),[`<strong>${e.name} (${t})</strong>`,"<ul>",...r.map(a=>`<li>${a}</li>`),"</ul>"].join(`
`)},P=()=>{const e=p(u),t=()=>{const n=!e.isMapEnabled;e.setIsMapEnabled(n),b({page:[n?"map":"list","map"]})};return o.jsxs(f,{id:"x-navbar",variant:"dark",children:[o.jsx(f.Brand,{children:"Restaurants"}),o.jsx(g,{className:"ms-auto me-auto",children:[!1,!0].map((n,r)=>{const a=n?"fa-map":"fa-rectangle-list",s=n?"Map":"List";return o.jsxs(g.Link,{onClick:t,active:n===e.isMapEnabled,children:[o.jsx("i",{className:"fa-solid "+a,style:{color:"hsl(0 70% 47%)"}})," ",s]},r)})})]})};function $(){const e=p(u);return x(()=>{e.data===null&&(console.log("Fetch initial data"),e.setData(S))},[e.data]),e.data===null?o.jsx("p",{children:"loading..."}):o.jsxs(o.Fragment,{children:[o.jsx(P,{}),o.jsx("main",{children:e.isMapEnabled?o.jsx(K,{}):o.jsxs(o.Fragment,{children:[o.jsx(U,{groups:e.data.groups}),o.jsx(A,{})]})})]})}const A=()=>o.jsxs("div",{className:"x-shadow",style:{marginTop:"2rem"},children:["Extra links:",o.jsxs("ul",{children:[o.jsx(y,{href:"https://www.theworlds50best.com/Best-of-the-best",children:"World's 50 Best Restaurants"}),o.jsx(y,{href:"https://guide.michelin.com/gb/en",children:"Michelin"})]})]});v.createRoot(document.getElementById("root")).render(o.jsx(M.StrictMode,{children:o.jsx(w,{children:o.jsx(C,{children:o.jsx($,{})})})}));
