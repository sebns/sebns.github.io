import{g as S,j as o,m as k,i as x,N as y,I as w,a as b,L as j,c as I,C as T}from"./Navbar-CXp4MzOV.js";import U,{createContext as C,useState as u,useContext as f,useEffect as h,useRef as K}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";var a=(e=>(e.UK="United Kingdom",e.ES="Spain",e.IT="Italy",e.DK="Denmark",e))(a||{});const L={initialZoom:4,initialCenter:[47.145,6.592],layers:[{name:"Map",urlTemplate:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},{name:"Satellite",urlTemplate:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, GIS"}],groups:[{name:"Home",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",points:[{coords:[51.508039,-.128069],name:"London",country:a.UK,info:"just as reference point"}]},{name:"3٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-violet.png",points:[{coords:[41.9933638,2.8076499],name:"El Celler de Can Roca",country:a.ES,info:"2012-11-29, 2015-11-28, 2017-02-14, 2022-11-26"},{coords:[44.6448264,10.9215729],name:"Osteria Francescana",country:a.IT,info:"2022-02-11"},{coords:[55.6828273,12.6104808],name:"Noma",country:a.DK,info:"2019-07-26"},{coords:[41.3877627,2.153199],name:"Disfrutar",country:a.ES,info:"2022-11-29"},{coords:[51.507914,-.701748],name:"The Fat Duck",country:a.UK,info:"2017-05-13"}]},{name:"2٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png",points:[{coords:[51.5203787,-.1365322],name:"Kitchen table",country:a.UK,info:"2017-06-10 + ???"},{coords:[51.5112554,-.1551559],name:"Le Gavroche",country:a.UK,info:"Tony 2015-06"},{coords:[51.502161,-.159964],name:"Dinner by Heston Blumenthal",country:a.UK,info:"Seb 2021-10"},{coords:[55.6722944,12.5889809],name:"Kadeau",country:a.DK,info:"2019-07-27"},{coords:[36.926756,14.741571],name:"Duomo",country:a.IT,info:"Seb 2016-10"},{coords:[51.5270972,-.0793385],name:"The Clove Club",country:a.UK,info:"2022-05-14"}]},{name:"1٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-gold.png",points:[{coords:[51.5147644,-.1575224],name:"KOL",country:a.UK,info:"2022-10-07"},{coords:[41.3767234,2.1540984],name:"Enigma",country:a.ES,info:"2022-11-28"},{coords:[41.3752608,2.1568707],name:"Tickets",country:a.ES,info:"2015-11?? + 2017-02-11"},{coords:[51.4926222,-.2676784],name:"Hedone",country:a.UK,info:"Tony 2018-06"},{coords:[51.5237542,-.0764767],name:"Lyle's",country:a.UK,info:"2022-06-18"},{coords:[51.5197892,-.1427257],name:"Portland",country:a.UK,info:"Maja 2023-02"}]},{name:"0٭",iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",points:[{coords:[51.5064253,-.1261457],name:"Ekstedt at The Yard",country:a.UK,info:"2024-09-28"},{coords:[41.984698,2.825606],name:"Restaurant Normal",country:a.ES,info:"2022-11-25"},{coords:[41.3845391,2.181679],name:"El Xampanyet",country:a.ES,info:"2022-11"},{coords:[44.6384889,10.931725],name:"Franceschetta 58",country:a.IT,info:"2022-02"}]}]},p=C(null),N=({children:e})=>{const n=S(),[t,s]=u(null),[i,c]=u((n.get("page")??"map")==="map"),[r,l]=u(null),[d,E]=u(0),M={data:t,setData:s,isMapEnabled:i,setIsMapEnabledWithURL:g=>{c(g),k({page:[g?"map":"list","map"]})},centreZoom:r,setCentreZoom:l,scrollTop:d,setScrollTop:E};return o.jsx(p.Provider,{value:M,children:e})},v=e=>{const n=/^\d+/.exec(e);return n?parseInt(n[0]):0},$=({groups:e})=>{const n=f(p);h(()=>{document.documentElement.scrollTop=document.body.scrollTop=n.scrollTop},[]);const t=[];return e.forEach((s,i)=>{if(s.name==="Home")return;t.push(o.jsx("div",{className:"x-delimiter",children:s.name},`${i}`));const c=v(s.name);s.points.forEach((r,l)=>{t.push(o.jsx(D,{point:r,numStars:c},`${i}-${l}`))})}),o.jsx("div",{children:o.jsx("div",{id:"x-list-container",children:t})})},D=({point:e,numStars:n})=>{const t=f(p),s=c=>{c.preventDefault(),t.setScrollTop(document.documentElement.scrollTop||document.body.scrollTop),t.setCentreZoom([e.coords[0],e.coords[1],15]),t.setIsMapEnabledWithURL(!t.isMapEnabled)},i=[...Array(n).keys()].map(c=>o.jsx("i",{className:"fa-solid fa-star-of-life x-star"},c));return o.jsxs("div",{className:"x-point",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[o.jsxs("div",{className:"x-list-item-title",children:[e.name,o.jsx("span",{children:i})]}),o.jsx("div",{onClick:s,children:o.jsx("i",{className:"fa-solid fa-map x-list-item-link"})})]}),o.jsx("div",{className:"x-list-item-info",children:e.country}),e.info&&o.jsxs("div",{className:"x-list-item-info",children:["info: ",e.info]})]})},P=({origin:e,destination:n,centreZoom:t,isSatellite:s,hasTraffic:i,isByFoot:c})=>{if(n&&!e)throw new Error("Cannot have destination without origin");const r=n?"dir":"place";let l=`https://www.google.com/maps/${r}`;e&&(l+=`/${e}`),n&&(l+=`/${n}`),t&&(l+=`/@${t}`);let d=s?"!3m2!1e3!4b1":"!3m1!4b1";return r==="dir"&&(d+=c?"!4m2!4m1!3e2":"!4m2!4m1!3e0"),i&&(d+="!5m1!1e1"),l+(d.length>0?`/data=${d}`:"")},R=e=>encodeURIComponent(e).replaceAll("%20","+"),m=window.L,Z=()=>{const e=f(p),n=K(null),[t,s]=u(null);return h(()=>{if(n.current===null)console.log("SKIP: Map div is not yet created (cannot create map yet)");else if(t!==null)console.log("SKIP: Map is already created (nothing to do)");else if("_leaflet_id"in n.current)console.log("SKIP: Map is already in the process of being created");else if(!e.data)console.error("Data not loaded yet...");else{console.log("Create a new Map");const i=A(n.current,e,e.data);s(i)}return()=>{t===null?console.log("SKIP: Map was already removed"):(console.log("Cleanup map"),t.remove())}},[t]),o.jsx("div",{id:"x-map",ref:n})},A=(e,n,t)=>{const s=Object.fromEntries(t.layers.map(r=>[r.name,m.tileLayer(r.urlTemplate,{attribution:r.attribution})])),i=G(t.groups),c=new m.Map(e,{center:n.centreZoom?n.centreZoom.slice(0,2):t.initialCenter,zoom:n.centreZoom?n.centreZoom[2]:t.initialZoom+(x?1:0),zoomControl:x,layers:[s.Map,...Object.values(i)]});return c.attributionControl.setPrefix(!1),m.control.scale({position:"bottomleft"}).addTo(c),m.control.layers(s,i).addTo(c),c.on("moveend",function(){const r=c.getCenter(),l=c.getZoom();n.setCentreZoom([r.lat,r.lng,l])}),c},G=e=>{const n={};let t=0;return e.forEach(s=>{const i={icon:new m.Icon({iconUrl:s.iconUrl,iconAnchor:[Math.round(12.5),41],shadowUrl:"https://cdn.jsdelivr.net/npm/leaflet/dist/images/marker-shadow.png"})},c=s.points.map(r=>{const l=`${s.name}: ${r.name}`;return m.marker(r.coords,i).bindTooltip(l,{permanent:!0,direction:"bottom",className:"x-tooltip"}).bindPopup(H(r,s.name),{className:"x-popup"}).setZIndexOffset(t--)});n[s.name]=m.layerGroup(c)}),n},H=(e,n)=>{const t=(r,l)=>`<a href="${r}" target="_blank" rel="noreferrer">${l}</a>`,s=[t(P({origin:e.coords.join(","),centreZoom:e.coords.join(",")+",12z"}),"Google Maps")];if(n!=="Home"){const r=R(`${e.name}, ${e.country}`);s.push("Search on "+t("https://guide.michelin.com/en/restaurants?q="+r,"Michelin guide")),s.push("Search on "+t("https://www.tripadvisor.co.uk/Search?q="+r,"Trip Advisor"))}e.info&&s.push("info: "+e.info);const i=v(n),c='<i class="fa-solid fa-star-of-life x-star"></i>'.repeat(i);return[`<strong>${e.name}</strong>${c}`,"<ul>",...s.map(r=>`<li>${r}</li>`),"</ul>"].join(`
`)},O=()=>{const e=f(p),n=()=>{const i=!e.isMapEnabled;e.setIsMapEnabledWithURL(i),i&&(e.setScrollTop(0),e.setCentreZoom(null))},t=e.isMapEnabled?"fa-rectangle-list":"fa-map",s=e.isMapEnabled?"List":"Map";return o.jsxs(y,{id:"x-navbar",variant:"dark",children:[o.jsx(y.Brand,{children:o.jsx(w,{src:"img/map_restaurants/favicon.png",height:"32"})}),o.jsx(b,{className:"ms-auto me-auto",children:o.jsx(b.Link,{onClick:n,children:o.jsxs("div",{className:"x-toggle-button",children:[o.jsx("i",{className:"fa-solid "+t})," ",s]})})})]})};function z(){const e=f(p);return h(()=>{e.data===null&&(console.log("Fetch initial data"),e.setData(L))},[e.data]),e.data===null?o.jsx("p",{children:"loading..."}):o.jsxs(o.Fragment,{children:[o.jsx(O,{}),o.jsx("main",{children:e.isMapEnabled?o.jsx(Z,{}):o.jsxs(o.Fragment,{children:[o.jsx($,{groups:e.data.groups}),o.jsx(W,{})]})})]})}const W=()=>o.jsxs("div",{className:"x-shadow",style:{marginTop:"2rem"},children:["Extra links:",o.jsxs("ul",{children:[o.jsx(j,{href:"https://www.theworlds50best.com/Best-of-the-best",children:"World's 50 Best Restaurants"}),o.jsx(j,{href:"https://guide.michelin.com/gb/en",children:"Michelin"})]})]});I.createRoot(document.getElementById("root")).render(o.jsx(U.StrictMode,{children:o.jsx(T,{children:o.jsx(N,{children:o.jsx(z,{})})})}));
